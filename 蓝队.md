# 蓝队

# 213：日志流量

资料中有手册-----应急响应------win+linux

日志：中间件日志-----开没开日志、日志保存路径改没改

写报告：攻击链、攻击时间，攻击点，漏洞、干了什么事情，修复建议、攻击的工具。

小案例、分开讲-------分知识点讲解：

IIS +  .net  看日志    ----------小翻车、换个IIS的机子  看日志。POST的请求没有记录提交记录

![image](https://github.com/user-attachments/assets/569717dc-a418-42aa-98b8-69f4e6c4c35d)

![image](https://github.com/user-attachments/assets/f2dd108c-a26d-4f66-a846-f0b5d1caa042)

先发现是有sqlmap，可能有sql注入，再看注入点为default.aspx  再看返回的状态码为200，那么就可以判断是遭受了sql注入攻击并且成功：

![image](https://github.com/user-attachments/assets/bfdb0946-b8b5-4687-9d21-316ebea0e4a5)


采用post注入成功、可以发现post请求没有记录提交

<img width="420" alt="image" src="https://github.com/user-attachments/assets/789abdf3-2f64-4d39-9096-a3bf2029fc53" />


43min  php+apache  这里为thinkphp的网页      看apache的日志logs  2个程序日志error 和httpd：

先找到web的对应apache下的日志记录、这里的日志就主要看打对勾的几个：
![image](https://github.com/user-attachments/assets/e5b55b6f-be00-4c5a-8c6c-194956fac817)




模拟攻击，然后查看日志:
<img width="420" alt="image" src="https://github.com/user-attachments/assets/b25826da-8d3f-4b47-96ed-f4593de889b1" />



<img width="420" alt="image" src="https://github.com/user-attachments/assets/7b3cb77b-b00d-4868-bc2b-f14496b2d4ae" />


<img width="420" alt="image" src="https://github.com/user-attachments/assets/47df4b8a-d976-4439-bcbd-103648347186" />


2

卡了到第二节课

找apache的日志。

1    web +tomcat   看日志，找后门文件：用一些在线或者本地下载的工具，还有蓝队应急响应工具箱：可以扫到后门，扫到后然后就在tomcat里看日志文件---一般日志为access的log文件就是记录登录访问的。

  演示后台拿tomcat拿shell过程。

![image](https://github.com/user-attachments/assets/c6f97edd-a7e0-4cda-822c-daeb10d47db8)



这里注意，2.war后需要将后门放一个目录就行，如1所示。序号2就是多了一层目录2，就等于需要访问2/2/2.jsp才能访问到。

![image](https://github.com/user-attachments/assets/b647ada9-6136-4367-9dca-29ecda976a3b)




这里用2.war就只需要访问一层 2/2.jsp就可以访问到：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/612c511f-f58a-432c-8470-a9d4417a8c44" />


然后下来就是看tomcat的日志（因为上传的是tomcat）：

![image](https://github.com/user-attachments/assets/3baa25b5-c2b0-47cc-b315-f9f92cda0c16)



就可以发现2.jsp后门，然后分析：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/2990dc7e-09cd-4b3c-8bd0-904058647b8f" />


如果这里2.jsp是免杀的或者我们发现不了他是哥斯拉后门，或者2.jsp不存在，那么下来就是看流量包了。

16min  模拟攻击流程 ，捕获流量。这里用wireshark代理edr流量设备。下来就是看哥斯拉的数据包，哥斯拉流量特征、用工具解密哥斯拉的java数据包，就可以知道是哥斯拉连接。

这里注意：wireshark抓包时候，抓不到本地操作的包，就是说如果你是在本地用哥斯拉操作本地的服务器，就是在主机上连接127.0.0.1的web后执行的流量是抓不到，这里是用kali上的哥斯拉操作，抓到的流量，抓的也是vm的网卡上的流量：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/de28f540-877b-409a-9b92-ca4ac980abd0" />


流量特征：

![image](https://github.com/user-attachments/assets/e71b6509-6f58-43b8-846a-5ab9a5bba44a)


还可以将捕获到的流量包放蓝队工具箱中解密：



<img width="420" alt="image" src="https://github.com/user-attachments/assets/a8e60fbf-f530-475a-b505-1538f82c553e" />


返回包解密：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/10bb82e2-e9d6-42da-92ee-30c8b23952d8" />


  有的日志中可能没有记录或者日志就没有开，那么就需要看流量包来看-----打开靶场（jar包，开数据库），shiro漏洞，（这里都是先模拟攻击者攻击后然后蓝队人员如何排查）捕获到流量包后解密。这里是用jar包开的靶场，这种的日志就在命令终端中，没有记录的。：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/b5069f42-3509-4c7e-9bf6-c3e92f0dfe95" />


有些日志中的记录可能还是加密过的，有时候还看不出来。这里测试shiro框架的流量。

还是将环境放到虚拟机中，在本机进行抓虚拟机的包，因为本机抓本机流量抓不到：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/d1e56840-92b1-4c55-afba-eb73bf02d912" />


抓包：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/207d527c-f890-4c34-9520-50cde74bfd6d" />


抓到shiro框架的流量rememberMe 后放到解密：

踩坑1、追踪http流，踩坑2、解密的只有rememberMe 后面的密文，不带rememberMe= 

<img width="420" alt="image" src="https://github.com/user-attachments/assets/4c9b02f9-cdd6-49a2-8452-f1369b465b92" />


另一款蓝队工具

就是用来破解一些加密流量，打一些OA系统时候会用加密流量打，这款工具就方便我们解密流量：

![image](https://github.com/user-attachments/assets/76c7bc9d-6dcd-4765-b5ed-ef69d2048e7c)



日志中的post包没有记录怎么办呢？就看流量包，里面的post有记录。

 web工具就看Web日志，入侵到服务器就看系统日志。

# 214：c2检测

蓝队：封锁----溯源-----反制

#### 检测

常规c2后门检测：

u    火绒剑，可以查看本地和外面的连接情况，还有可以看安全状态。爆红的需要注意。然后就找到后门后自己判断，完了上传微步、云沙箱。还可以用工具打开检测，还有看应急响应手册看一些可以上传后门的在线监测平台。

定性：后门为哪种c2工具，msf cs viper sliver vshell havoc 响尾蛇等

人工分析：数据包流量，文件逆向分析。平台分析：文件或者IP域名。

火绒剑：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/4b17302b-9e14-42ce-bca4-16fd857f0f19" />


找到后门可疑文件后，然后直接提交微步这类平台或者用工具箱中的威胁情报查询：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/9192f03d-63de-47da-b208-bb3662d5a414" />


#### 封锁

处置   清理：进程结束后删除、    

 ：防火墙封锁：1、进程名   2、网络限制     3、限制协议

 防火墙演示            ip 封锁 或者进程封锁	类似于aliyun的安全组

<img width="420" alt="image" src="https://github.com/user-attachments/assets/37222437-938e-4cfe-8ccf-007344422fd9" />


在出站阻止程序：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/3ece0568-ac6f-4ab6-a6c7-eb66acd4c395" />


封ip：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/606341b8-a7c4-4761-92c2-f8acb80350d1" />
<img width="420" alt="image" src="https://github.com/user-attachments/assets/8c66f173-e351-4d5d-8d4d-30d71b25c24d" />


还可以通过协议封。

#### 排查

火绒剑查看启动项-----看有没有一些维权的后门

<img width="420" alt="image" src="https://github.com/user-attachments/assets/e7b75272-a461-453e-a105-e816358fc6a5" />


就可以在启动项里进行排查：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/14f77288-60a1-403f-aefb-4312d795d0b9" />


<img width="420" alt="image" src="https://github.com/user-attachments/assets/91a68942-fffd-4ef9-bc36-0616b867c5d8" />


#### 基线检测

#### windows

  基线检测：属于应急响应后面部分，结束处理后门后，就要提出修复建议，指出一些潜在威胁（哎，就是水报告一样，水任务的）混的。骗客户的。

golin  需要管理员运行，运行后会对当前系统进行扫描。

d-eyes推荐，监测当前全部在威胁

两款检测自身的软件    ------- golin和 windows基线：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/d08660af-ee96-4b37-872d-3fa55514544e" />



##### findall

检测工具：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/58ef7741-b071-467f-8e59-48b175fd6d03" />


检测目标就是将服务端上传到目标主机上执行，然后在c盘下产生文件result.hb，将此文件放到刚才的客户端中进行分析（这里运行都是管理员）：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/3a8f3982-70a9-47bb-bf02-37b5662f6c66" />


得到分析结果：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/48011e3b-7e7f-44f2-afe2-0165e6bbf6d6" />


##### d-eye

https://github.com/m-sec-org/d-eyes

<img width="420" alt="image" src="https://github.com/user-attachments/assets/9f9abbd1-55b4-40e0-9a28-4afc16797ba3" />

#### linux： 

  linux 中进行检测可能存在威胁

https://github.com/sun977/linuxcheckshoot       可以看到一些威胁软件，特权命令，定时任务等

<img width="420" alt="image" src="https://github.com/user-attachments/assets/02c38274-ab5f-4fd3-9db0-fb8c6126e32f" />


https://github.com/m-sec-org/d-eyes

<img width="420" alt="image" src="https://github.com/user-attachments/assets/ce34e2de-e719-4669-9fd7-a12239f08c23" />


https://github.com/selinuxG/Golin

<img width="420" alt="image" src="https://github.com/user-attachments/assets/4e4348cf-f2b5-4922-a9b9-2685483c3f8e" />


 linux 上线cs           cs后门的心跳包原因，所以导致在linux中会找不到通讯地址，就是有延迟

<img width="420" alt="image" src="https://github.com/user-attachments/assets/8f5a6b57-f74b-45a8-8794-3f932b7ad57f" />


执行命令产生linux后门、踩坑：这里细看，上面cs插件生成linux的为https 所以我们监听器也应该为https，这里是http的监听器，所以没有上线成功，重新走一遍成功上线：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/fbe5009b-371f-4071-94d6-cd2d18c5bc73" />


上线后发现，linux没有开对应通讯连接，这里就是因为cs的心跳包导致的：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/b1fb9d88-68e4-4fc9-9eb1-b646a558fc75" />


用刚才的检测工具来检测网络也没有发现有对外的连接，所以这就是cs的好处。msf就没有：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/dced5ebb-9d97-49dd-a5da-c0be1a6b079b" />




 msf  linux上线       这下就可以看到通讯了，然后就可以用刚才的工具检测出来后门存在。

<img width="420" alt="image" src="https://github.com/user-attachments/assets/0738bfe5-8f60-486a-b93d-4c12c704a350" />


msf没有心跳包，那么就可以检测出来通讯：

<img width="420" alt="image" src="https://github.com/user-attachments/assets/cc06062d-5020-4a37-9e57-092d6756f2ee" />


# 215：挖矿

数字货币、现象：cpu/gpu拉满，网络堵塞，服务器卡顿。

分析：进程找到文件，生成平台分析、网络找到外链，生成ip分析

处置：排查入口攻击点，重启隔离主机，排查重启生效项（启动项，计划计时任务等）可以将挖矿病毒放到启动任务中。

#### windows

##### 1

14min    挖矿病毒在计算器重启后还是会自动运行。就需要删除后门。

xmref'    挖矿病毒还要找到是哪个家族，执行后cpu拉满，而且还需要找有没有留后门自启动的

启动挖矿进程：

![image-20250107171359322](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107171359322.png)

然后结束update64进程，重启电脑发现进程自己启动：

![image-20250107171830734](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107171830734.png)

上传微步分析域名，确定为挖矿进程：

![image-20250107171949286](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107171949286.png)

用火绒剑也发现启动项中有这个进程，应该是伪装为google的，来实现调用挖矿进程：

![image-20250107172223936](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107172223936.png)

将其禁用删除可能会删除失败，就先将对应进程结束，再查看注册表删除注册表后，重启查看是否清理干净：

![image-20250107172543475](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107172543475.png)

##### 2:

xmrig.exe

![image-20250107173341258](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173341258.png)

还是很容易发现的：

![image-20250107173511565](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173511565.png)

分析文件：

![image-20250107173617639](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173617639.png)

查看配置：

![image-20250107173658776](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173658776.png)

分析url，基本锁定为挖矿：

![image-20250107173741255](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107173741255.png)

##### 3

排查方式和上面一样：

![image-20250107174100061](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107174100061.png)

#### linux

 30min update.sh  写任务，下载病毒，在主机上把别的挖矿病毒停了（让自己的脚本不会被影响），把自己的样本放上去。然后在写维权。

**![image-20250107175001727](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175001727.png)**

![image-20250107175254452](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175254452.png)



36min   现象也是cpu拉满，网络卡顿。

![image-20250107102200706](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107102200706.png)

这种就是将sh加密处理的：

![image-20250107175431840](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175431840.png)

还有将脚本编译的，要看里面的内容需要将反编译出来：

![image-20250107175533539](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175533539.png)

#### 1：

![image-20250107175714105](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107175714105.png)

cpu拉满，还会对外通讯：

![image-20250107180536165](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107180536165.png)

top命令查看进程，找到占用cpu的进程PID，直接kill -9 就行：

![image-20250107181004619](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107181004619.png)

44min 

##### 靶场：

这里环境懒，没有配， 以xd的视频为主。

找到可疑文件，打开cinfig文件发现存在url，检测为矿池url。是先封堵在清理后门，而不是直接清理。

![image-20250107190713565](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107190713565.png)

发现有大量的外部连接：

![image-20250107190934217](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107190934217.png)

思路一样，还是找到占用率高的文件，打开里面的配置文件：

![image-20250107191017205](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191017205.png)

上传在线的平台分析、基本确定为挖矿：

![image-20250107191053427](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191053427.png)

先堵入口，在清理后门：

下来的思路：看他是怎么打进来的。先排查服务器上的资产信息-----看有没有什么web服务，或者其他一些漏洞，弱口令，钓鱼等，是不是内网机器，内网打进来的。看日志排查：本台机器中是通过爆破进来的，看系统日志。

看程序时间，基本定位入侵进来的时间：

![image-20250107191226878](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191226878.png)

netstat -anpt  查看是否有web，这里没有web服务，所以就看系统日志：

![image-20250107191548755](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191548755.png)

根据刚才的时间，然后再看登录成功和登录失败的临界点，就是符合攻击者一直测试然后进来的情况，总不能一次就登录成功了：

![image-20250107191952881](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107191952881.png)

可以查事件id：

![image-20250107192639573](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107192639573.png)

下来就是进行封堵，开个防火墙，封ip，改密码之类操作。



1h 发现入口，利用解题系统（蓝队工具），下来就是清理挖矿病毒，结束进程，结束不掉，可能是计划任务影响的，就找到计划任务删除任务，但是发现还是结束不了进程，然后就在服务中找，找到了调用病毒的服务，禁用在删除服务，在结束进程就可以。

结束进程后又自己启动，这种多半就是计划任务或者服务里有启动的：

![image-20250107192925211](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107192925211.png)

计划任务：

![image-20250107192957932](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107192957932.png)

删除计划任务后发现还是没法终止挖矿进程，那就在看看服务中是否还有对应的在运行，停止可疑服务，删除服务就需要在命令终端中敲del .........：

![image-20250107193251920](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107193251920.png)

停止服务后就可以结束进程：

<img src="E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107193552740.png" alt="image-20250107193552740" style="zoom:67%;" />

下来就是防护，但是发现重启后，电脑又自己执行命令，然后开始执行了挖矿程序，这里发现是刚才的计划任务中的遗留bat文件没有删除，刚才只是删除了计划任务，没有删除计划任务调用的程序。然后再封ip后期。反正就是将他维权的一系列留下来的操作找到并清理干净，使用重启看是否清除干净。

重启电脑后刚才本来都结束的进程和删除的挖矿文件又启动出来，而且会自己运行一段命令窗口：

![image-20250107193941026](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107193941026.png)

可以从上面的计划任务中看到，你只是删除了计划任务，但是没有删除他调用的bat文件，所以没有清理干净，这个bat文件会调用过程已经禁用的服务，从而执行任务。那实战中你如果刚才忘了删bat文件，现在回去发现计划任务已经被你删了，找不到对应的bat文件在哪儿了，这时候就看刚才刚开机执行的那个命令行，从里面找信息，查到bat的路径：

![image-20250107194219306](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107194219306.png)

下来还是将刚才的服务停止：

![image-20250107194322012](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250107194322012.png)

然后在重启就没事了，这时候才清理干净，下来就是防护，防火墙拉黑，改密码后续。



### 后面看

1h19min   linux    上期164day  可以看。这里vm的版本不合适。

https://mp.weixin.qq.com/s/OuzkbDRVqeNmH_kgptjwug

找到了进程文件，但是删除不了，上锁了，就需要解锁，再将几个核心的文件删除，再结束进程删除文件。





# 216：勒索

也是数字货币或者区块链

危害较大，解密难，遇到了就交钱吧，，，原理是将你电脑上的许多文件进行加密，你自己看不了，只能支付赎金。

传播方式和挖矿进入的方式一样。也有家族分类。

不可逆的加密：

记得快照，样本在虚拟机中：23min  还是可以上传到平台定性，然后解密，不过大部分自己都解密不了。下来就是找人帮解密。

特征就是自己的文件后缀异常，然后打开内容是被加密的

![image-20250108222500983](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108222500983.png)

正常文件的后缀变了：

![image-20250108222601570](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108222601570.png)

![image-20250108222718040](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108222718040.png)

可以将中毒的文件上传到一些平台上检测：

![image-20250108223055123](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108223055123.png)

40min  可逆的加密方式：可以解的勒索病毒。有工具，这里是通过勒索的邮箱人工分析到勒索病毒的解密工具，

![image-20250108235834108](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108235834108.png)

这款可以解密：

![image-20250109000150851](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109000150851.png)

使用解密工具成功解密，就是需要将要解密的文件放一起，放在解密文件路径下：

![image-20250109001217168](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109001217168.png)



49min  linux勒索

![image-20250108214959501](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250108214959501.png)



1h02min  勒索病毒的防范，注意入口封锁。

# 217：钓鱼防范

主要还是溯源，根据发件人地址。

7min 可以看邮件的eml文件，从里面获取相关信息进而溯源。

![image-20250109203524656](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109203524656.png)

![image-20250109203715723](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109203715723.png)

17min  真实钓鱼 

下面这种，他两个域名不一样，钓鱼用的为白名单域名，但是底下为什么不用白名单呢，一方面是因为防溯源，一方面是会收到白名单域名官方的管制。

![image-20250109204252890](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109204252890.png)

明显为钓鱼的：

![image-20250109204541325](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109204541325.png)

31min  对钓鱼文件进行定性分析，蠕虫病毒，这钓鱼文件还是做过免杀的，里面有防沙箱，虚拟机，防逆向的。

![image-20250109205722002](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109205722002.png)



43min 在服务器中运行

在自己本地上也运行一下安天的分析工具，看看自己主机上有没有后门（ctf那个程序）

53min  分析后门。在你的主机上获取你的所有邮件信息，然后尝试将他的邮件文件（后门文件）通过你的邮件账户发送到各个地方，典型蠕虫病毒。这里就是需要逆向和二进制的知识。

就是自己中毒了，但不会分析，还可以就是找这个毒，看有没有人分析过。：

![image-20250109210753248](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109210753248.png)

##### 考你：

1h02min  面试或者比赛  有时候会给你一个文件，让你分析这是啥。这里分析的文件里面为白名单域名，但是有时候是白名单域名也不一定是白的，他有可能被别人拿下整个服务器然后利用来攻击，

有附件和没附件的邮件的eml内容不同

给你一个，check.eml，让你开始分析有没有危害，什么危害：

![image-20250109210906973](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109210906973.png)

开始查，找：

![image-20250109211239676](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109211239676.png)

初步判断为垃圾钓鱼，还需要深入调查，那就得根据里面内容或者附件确认了：

![image-20250109211604910](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109211604910.png)

kali ------base64解码：

![image-20250109212133047](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109212133047.png)

解码后里面提示有解压密码，那么就猜测是不是有压缩包，而且有filename和application这种特征：

![image-20250109212306086](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109212306086.png)

![image-20250109212608463](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109212608463.png)

基本确定是有附件的，那么目前是只给了你一个eml，没有附件。那就得将下面那些加密的数据导出为附件：

那么一般为zip文件，但是也有可能为rar，所以我们在将filename解码：

![image-20250109213208421](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109213208421.png)

那就用kali将他导出：

![image-20250109213645803](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109213645803.png)

上传微步，查找资料定性：

![image-20250109213818988](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109213818988.png)


木马家族：Rozena

![image-20250109215052307](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109215052307.png)

# 218：爆破

外网爆破成功率比较低。内网爆破比较常见，成功率较高。

内网容易爆破，一方面是方便运营，还有也是因为内网本身就安全，你很难通讯到内网。

#### linux---ssh

面试问过：

![image-20250109225720973](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250109225720973.png)

unbutu 的日志在/var/log/auth.log：

![image-20250110121232616](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110121232616.png)

13min   爆破测试，查看日志。----16min      ssh爆破

没爆破前看日志中的成功和失败都没有：

![image-20250110121725469](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110121725469.png)

爆破后查看：

![image-20250110121849377](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110121849377.png)

![image-20250110121948961](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110121948961.png)



#### windows

这里有RDP、SMB没有wmi是因为wmi不会再目标日志系统留下痕迹，所以没有日志可以分析。

25min   RDP安全日志  看关键字和事件ID     事件ID：4625/4624      登录失败/成功         登陆类型：2/3/5/10这几种类型也需要留意，一般就是爆破类型。

这里看时间也可以判断为爆破，一秒的登录次数：

![image-20250110123742101](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110123742101.png)

爆破失败的id和类型：

![image-20250110123818366](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110123818366.png)

![image-20250110124111430](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110124111430.png)

清除日志也会记录：

![image-20250110145209569](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110145209569.png)

38min  SMB

sql（32）攻击dc（21）机

![image-20250110145548270](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110145548270.png)



![image-20250110145637220](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110145637220.png)



MSSQL

45min sql 应用的日志存储。

![image-20250110145946390](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110145946390.png)

web（31）攻击sql

![image-20250110150446085](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110150446085.png)

![image-20250110150824070](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110150824070.png)



FTP日志，找谁搭建的ftp就看谁的日志。谁提供的就找谁，不是日志都在windows系统里。

#### 隧道技术

当收到攻击者是通过隧道技术进来的，我们怎么处置发现。

linux ------ icmp：1h03min    socks是代不出来icmp协议，icmp是底层协议。

![image-20250110154103179](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110154103179.png)

centos是我们的受害机，被攻击者建立了icmp通道进行通讯，我们需要找到通道并且关闭。

使用工具可以捕获到icmp数据包的连接情况，找到发起icmp的进程id，来结束进程。

![image-20250110152157879](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110152157879.png)

然后在centos的机器上是看不到icmp的包对外的情况，为:::*    就是不知道远程ip，用这种netstat -anpt这种通讯是看不到icmp的网络流量。因为正常来说应该是和上面一样，有本地和远程ip的端口显示：

![image-20250110152236816](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110152236816.png)

所以网络是正常来说分析不到，那么就得借助工具来对icmp进行监控：

[bpftrace对icmp进行监控，查看icmp包是哪个进程发出的_linux bpftrace跟踪发网络报文进程-CSDN博客](https://blog.csdn.net/native_lee/article/details/124751325)

![image-20250110152558787](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110152558787.png)

上传工具：

![image-20250110152752693](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110152752693.png)

![image-20250110153212916](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110153212916.png)

监听找到icmp的行为：

![image-20250110153543455](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110153543455.png)

查看pid对应的进程：

![image-20250110153700053](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110153700053.png)

下来就是kill这个进程，然后删除对应的进程文件。

1h12min  windows---icmp

windwos自带监测icmp数据包，可以找到icmp的进程，进而找到发起进程的工具文件，然后分析。

![image-20250110154914730](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110154914730.png)

使用wireshark监听受害机的eth1网卡（和攻击机通讯）：

![image-20250110155029360](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110155029360.png)

这里还是只能分析到网络流量，但是无法知道进程和谁发起的这个进程，我们怎么阻止找到这个发起进程的文件：

![image-20250110155202805](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110155202805.png)

这里用到的是一款微软自带的抓包工具MessageAnalyzer，当然不止能抓icmp，还有Dns这些都可以，然后记得管理员运行才可以，抓到对应的icmp包后查看进程信息：

![image-20250110160105494](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110160105494.png)

注意：上面的icmp包要分析找对，别分析半天发现不是攻击者的那个数据包。

然后查看pid后用进程查看工具（火绒剑）找到对应进程pid，就可以锁定对应的进程文件，进而清除或者分析溯源：

![image-20250110160743375](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250110160743375.png)

# 219：docker

近源+docker

7min  docker中的镜像被植入挖矿病毒。服务器上有一个进程占用cpu，然后kill后也会自己启动，但找不到对应的文件，然后就发现这个进程运行在docker镜像里。

先top命令发现有占用cpu过大的进程：

![image-20250111152810757](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111152810757.png)

ps -aux  查看进程，根据上面的top找到的pid号来查看进程所在的位置，发现在当前目录：

![image-20250111153000766](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111153000766.png)

然后 查看当前目录没有发现对应的文件：

![image-20250111153132042](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111153132042.png)

然后在看刚才的top进程中发现有个systemd的进程，这个一般就是 docker镜像进程运行的一个进程，那么结合我们刚才找不到进程文件，而且kill也结束不了进程，所以判断这个进程是在docker容器里：

![image-20250111153227041](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111153227041.png)

那下来就看docker来进一步排查了：

1、查看dokcer进程 	2、看这个进程对应的历史命令     3、根据刚才top找到进程名为xmrig，所以只找有xmrig信息的。

![image-20250111153745211](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111153745211.png)

然后从上面也可以发现，这个文件似乎在 /home/miner/xmrig下。但是我们没有找到，那是因为这个镜像是在docker里，不在我们的本机上：

![image-20250111154122847](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111154122847.png)

然后就进入docker容器，发现了目标xmrig文件：

![image-20250111154312151](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111154312151.png)

那下来自然就很明显了，结束这个进程然后删除文件就行。当然不会这么简单，这里发现，结束进程后他又运行：

![image-20250111154923906](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111154923906.png)

22min  alils      dokcer和本机的关系就类似是虚拟机和本地之间的关系。那么就很清楚了，那么docker上的镜像文件自然也是在真机上。       我们就在docker上找到对应占用服务器进程的镜像，在找dokcer上的镜像的位置，在找其在真机下对应的位置。            先找镜像在哪---------->找到镜像在docker里的存储位置-------->在找对应在真机里的存储位置。   和虚拟机一样，找虚拟机里的文件，也是先找虚拟机在真机里的存储位置，在找其文件在真机里的位置

![image-20250111155616068](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111155616068.png)

![image-20250111155410024](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111155410024.png)

使用dfimage从镜像中提取Dockerfile，在这里可以清晰地看到恶意镜像构建的过程。就是用dfimage可以看你的镜像到底是咋弄的，怎么运行起来的：

![image-20250111155550397](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111155550397.png)

这里就是docker的磁盘路径，dokcer会加载许多磁盘路径，下来就是我们一个一个试，看刚才对应文件是在/home/miner/xmrig/build 下，其实这是docker的路径下，我们就需要找看是在哪个磁盘路径下存储着：

![image-20250111155711552](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111155711552.png)

那找到文件下来就简单了，先传出来定性判断一下，在删除文件后再kill 进程，然后发现他就不会在继续重新运行了：

![image-20250111160146797](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111160146797.png)



41min  重新拉一次镜像

#### 靶场

48min    docker本身漏洞

先用docker搭建一个shiro的靶场，模拟红队拿下并植入哥斯拉的内存马，上传后门flag：

![image-20250111171454566](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111171454566.png)

50min  模拟红队入侵后蓝队排查。      翻车

然后模拟蓝队排查，前面怎么发现被植入后门就不演示了，可以用docker监听网络的工具进行发现异常连接。

下来就是排查：

![image-20250111172034549](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111172034549.png)



1h04min  有一个检查当前docker环境是否有漏洞的项目。第一次项目不用弄了，ubuntu不合适，适合第二个格式.deb文件。

![image-20250111172508548](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111172508548.png)

![image-20250111172737385](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250111172737385.png)

扫描出来的结果可以用来写一下修复建议等。



1h12min  近源------宏

近源最后也是得上线，就看好上线的通讯就行。 

https://mp.weixin.qq.com/s/WBFTtAuyC7PauFZbNBja5Q

# 220：内存马查杀

java中比较多，

5min   配环境 

8min  植入哥斯拉内存马，无文件马。用脚本jsp，可以查看当前目录下是否有内存马，也只能用于一些常见传统内存马。

![image-20250115111126856](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115111126856.png)

这里植入内存马要注意：1、植入的是在进入的后门路径下 	2、密码要对应	3、连接进来的后门什么类型java，内存马也是对应的java类型

![image-20250115111257532](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115111257532.png)

自然，在对应目录下只能找到常规的后门文件，没有内存马的文件。

##### 1   .jsp脚本

第一个查杀内存马项目，tomcat-memshell-scanner.jsp，将这个脚本放到可能存在内存马的目录下，直接访问就可以检测出来是否存在内存马。找到添加的server  和filter两个类型内存马：

![image-20250115112302534](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115112302534.png)

但是这个脚本比较局限，一般适用于常见的内存马()和常见的框架（tomcat）：

![image-20250115112512226](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115112512226.png)

然后这个可以把内存马dump下来分析，或者直接kill掉：

![image-20250115113209738](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115113209738.png)

##### 2   arthas

17min  另一个项目，是用来监控内存的。我们可以用它来检测内存马。20min  运行jar打开项目，失败可能是因为java版本问题。.\arthas-boot.jar

![image-20250115113708649](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115113708649.png)

启动jar包后会自动检测当前环境里运行的java环境，然后选择你当前需要他进行检测的java环境。

1、启动jar包，发现了2个java进程，1是哥斯拉，2是tomcat，	2、那我们要检测的是tomcat下是否有内存马植入，选择2  	3、报错，java版本错误	4、更换成1.8_291重启启动成功：

![image-20250115113958531](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115113958531.png)

查看url路由，（找Servlet内存马），因为正常来说，路由有的，你目录下也是有对应的路径的，但是内存马就是有路由，但是目录下没有对应文件。但是这里好像只能识别出servlet型的

一些简单使用的命令。

这里用查看URL路由，发现了servlet型的内存马：

![image-20250115150650294](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115150650294.png)

28min 利用sc命令，查看JVM 已加载的类信息，反编译指定已加载类的源码或者直接下载下来分析。

sc查看JVM 已加载的类信息，然后配合经验或者刚才的脚本来找到哪个可能是内存马调用的java类、通过搜索发现里面的node.BaseJsonNode不是系统自带的，怀疑可能是：

![image-20250115163035177](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115163035177.png)

jad反编译指定已加载类的源码、进一步分析：

![image-20250115175326646](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115175326646.png)

dump下来目标class文件：

![image-20250115175555471](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115175555471.png)

打开class（idea或者jadx-gui）打开发现一些哥斯拉的特征。什么连接方式，AES_BASE64、连接密码等这些信息：或者就直接复制粘过去让gpt分析一下：

![image-20250115175837342](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115175837342.png)

41min  找servlet ，拿到class文件后分析：

![image-20250115181010544](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115181010544.png)

下来还可以将dump下来的class文件打开，保存到java格式、上传微步分析：

![image-20250115181657127](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115181657127.png)

51min  许少的工具，查找内存马工具

但是这些还是有局限，只能查杀部分类型的内存马。

![image-20250115184540712](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115184540712.png)

1h03min  还可以通过日志发现：当本地路径中没有这个文件，但是你的访问路径（攻击者访问）有这个文件，而且的状态是200的post请求，那么就怀疑这里是不是有内存马。

![image-20250115192146605](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250115192146605.png)

https://github.com/Getshell/Mshell

# 221：内存马2

9min  listener 框架的后门      哥斯拉不支持linstener的内存马，可以用脚本或者工具植入。查杀还是用项目arthas-bin，就是需要将查找语法自己写。

##### listener

使用jar包工具生成listener内存马：

![image-20250116110616219](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116110616219.png)

然后访问就植入了：

![image-20250116110922433](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116110922433.png)

listen.jsp内存马：

![image-20250116111137313](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116111137313.png)

然后查杀就可以用上面的脚本，也可以用其他几个都行。

中间件内存马：

![image-20250116114604021](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116114604021.png)

25min  

##### tomcat valve        

![image-20250116112427486](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116112427486.png)

中间的路径都行asd?

![image-20250116112541712](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116112541712.png)

查杀：

gui和arthas都可以查杀、jsp脚本就在这儿用不了了：

![image-20250116112805330](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116112805330.png)

这里还有一个项目，也可以查杀，但是不如arthas，因为他是将所有结果放到txt里让你自己分析，没有自动匹配：

![image-20250116113306386](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116113306386.png)

##### spring

框架型内存马：

![image-20250116114548480](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116114548480.png)

35min  spring boot  框架       先不考虑如何植入的，是用代码进行植入的。访问对应地址就会触发内存马。----小翻车  jar包有问题，用idea启动环境。41min              gui是查不出来这类内存马的，用cop或者arthas两个项目进行查杀，推荐还是用alibaba的arthas进行查杀

至于这里具有为什么访问那个路径就植入内存马（spring boot 型），为什么访问参数是cmwpzz，那都是得看源码，他是放到源码了，然后给你打包jar包让你直接运行了：

![image-20250116114133081](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116114133081.png)

这里还是推荐arthas，但是缺点也很明显，就是查找语法你得自己找，找到正确的，然后那个cop的jar包也可以找到， 只是需要自己找。

52min  使用arthas进行语法搜索，因为你是作为蓝队，那么是自己当前的环境肯定是知道的，为spingboot框架的，那spingboot根据资料，就那3种类型：SpringController、SpringInterceptor、Spring Webflux         那就根据这个类型进行语法筛选：

![image-20250116115543853](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116115543853.png)

SpringInterceptor：

![image-20250116115657185](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116115657185.png)

找到后在jar包中将对应的class文件删除（删除内存马）

![image-20250116152315063](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116152315063.png)

##### webflux 

1h04min webflux        ，内存马已经植入了（运行网页时候就植入了），什么路径都可以进入：

![image-20250116152558425](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116152558425.png)

内存马也是写到里面的class文件，这个查杀时候，需要用到关键字筛选memshell shell os  runtime都是一些java代码rce的关键字，需要区分大小写：

![image-20250116153320803](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250116153320803.png)



这里查杀时候，主要还是查找语法，有的基于内存马固定后缀，名字，文件中的一些可疑关键字来查找。

# 222：rookit

维权技术：web：内存马 webshell     服务器：Rookit技术C2后门

一款用来分析，逆向的工具箱：

![image-20250117111006861](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117111006861.png)

13min   上线msf ，查杀c2后门。直接用一些工具就可以发现c2后门：

![image-20250117111427890](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117111427890.png)



18min 所以需要对c2后门进行处理，就是rookit技术。可以隐藏网络，进程，位置。

   蓝队检测rookit技术，需要知道攻击者用的Rookit是什么“家族”。

使用r77-rookite工具隐藏后门，可以让一般的进程工具找不到，但是火绒剑还是能看到：

![image-20250117111945171](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117111945171.png)

还可以加远程端口实现隐藏，文件开头为$77开头实现隐藏文件。

![image-20250117112506410](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117112506410.png)

这个r77只是rootkit的一个家族，一个类型。rootkit有许多家族。如果不知道rootkit技术，是比较难排查出来并解开的，就像勒索解密一样。

就如果你（蓝队）知道攻击者用的是r77技术实现的，你就可以找到对应位置或者自己也下一个相同版本的点击unintall卸载掉，那就解决了rootkit。不过这种可能性低。

![image-20250117112918659](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117112918659.png)

##### unhide

28min  一个项目，可以发现被隐藏的进程端口。开源的，所以功能也受限，有些商业产品可以很好的检测rootkit技术 

![image-20250117113735079](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117113735079.png)

找到本地与外面通讯的被隐藏的端口：

![image-20250117114120721](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117114120721.png)



35min   封ip          下来就是封ip，封远程端口：

![image-20250117114923404](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117114923404.png)

这里一般都是封远程ip端口，因为本地的端口是会变化的：

![image-20250117115033148](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117115033148.png)

42min  演示msf控制，用unhide  工具来发现rookit隐藏的进程文件。开源的，商业不知道

https://mp.weixin.qq.com/s/LnqArTrAytMKtitGvplNug

这款工具可以查找隐藏的进程，也是有限，毕竟是开源的。

##### rkhunter 

![image-20250117154613772](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117154613772.png)

1h      火绒剑是可以检测到隐藏的进程，网络隐藏是检测不到的

##### clamav 

1h11min  clamav         linux上的杀毒，但查杀rookit基本不可能，常规木马可以发现。

![image-20250117164821365](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117164821365.png)

最后还是clamav   unhide比较好点

# 223：小工具(日志)

混子工具

日志：提权---------查看--------分析







日志自动提取

#### 采集：

![image-20250118155845994](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118155845994.png)

Logkit

15min   七牛Logkit

启动：

![image-20250118160320955](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118160320955.png)

打开对应ip+port
![image-20250118160344664](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118160344664.png)



运行后采集的日志保存到服务器本地上（192.168.139.143）路径你指定的，然后也自带有分析日志的工具。

![image-20250118173116762](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118173116762.png)

20min  日志提权分析工具、只能对系统上面进行分析。

![image-20250118171733219](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118171733219.png)

分析查看：

![image-20250118172252326](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118172252326.png)



日志自动查看

24min  LastActivityView 工具。查看器，看你在你电脑上干什么了、登录、删除、打开软件等操作。能动态的看用户。

![image-20250118172424843](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118172424843.png)

26min Fulleventlogview 日志事件查看器

![image-20250118172555446](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118172555446.png)





#### Web日志查看

自动分析：

30min  360星图     也只支持一些常规的：.net  .php 。改配置文件，指定需要分析的日志文件。

36min  可惜不支持java的

![image-20250118173506300](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118173506300.png)

start.bat：

![image-20250118173611659](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118173611659.png)

40min GoAccess（任何自定义日志格式字符串，安全涉及少）不是针对安全进行分析的，所以不太适用。

![image-20250117174645886](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117174645886.png)



内网分析：

48min  wincheck_log

![image-20250118174141621](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118174141621.png)

55 min  chainsaw    使用简单。自己的规则和语法进行分析日志。

![image-20250118183136966](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118183136966.png)

分析结果：

![image-20250118183503180](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118183503180.png)

59min  较难搭建：比较占内存。LogonTracer       上传日志后会自动分析，然后找日志中的一些可以操作。---------翻车 1h18min    xd视频演示：

获取的日志上传分析：

![image-20250118184052255](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118184052255.png)

分析结果：

![image-20250118184608628](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118184608628.png)



#### linux

1h19min  linux一些日志检测、大部分为批量检测：

https://github.com/grayddq/GScan

https://github.com/enomothem/Whoamifuck        好用点

https://github.com/Ashro-one/Ashro_linux

![image-20250118184444886](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118184444886.png)

apt-hunter



最后还是得看自己分析，自己写一些规则来分析，特征分析，yaml语法。

# 224：ELK

适用的是数据较大的：

![image-20250117195809448](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250117195809448.png)

5min  环境配置

搭建：Docker搭建。

12min  成功搭建，进入查看部署。三种模式：上传文件，特定分析，代理加入。上传日志---上传文件。在自己的主机上配置后，主机就会将自己日志发送到平台上分析----代理加入。

里面有许多常见的系统，框架日志。

上传文件：

![image-20250118191350816](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118191350816.png)

分析结果，还可以用一些语法进行查找：

![image-20250118191833247](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118191833247.png)

![image-20250118192111561](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118192111561.png)

![image-20250118192202583](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118192202583.png)

23min  将目前系统日志上传上去进行分析。找到对应系统---Linux:

![image-20250118192509733](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118192509733.png)

开始配置：

![image-20250118193111334](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118193111334.png)

配置后就可以看服务器/主机上面的日志，并且分析。

![image-20250118193543971](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118193543971.png)

![image-20250118193643652](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118193643652.png)

#### yara

 38min  yara-----VT下的一个产品

里面靠规则库查杀的，有的规则需要付费。

47min yama使用指定规则对目录进行扫描 。yar规则，这里面的自带库是比较老的，需要自己写或者网上找。

![image-20250118194950982](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118194950982.png)

可见用的yar规则是比较老的，连目录里面的哥斯拉后门都没有识别出来，还可以识别里面用的什么加密算法：

![image-20250118195331947](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250118195331947.png)

[YARA规则与办公安全：高效检测策略 (qq.com)](https://mp.weixin.qq.com/s/Ng8My7P3yIvDtEriacrZYw)

58min  自写yar规则。 规则好写，但是目标的强特征难找，要找的样本特征难。

![image-20250119005525373](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119005525373.png)

![image-20250119005615250](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119005615250.png)



1h08 ------- 1h13  编写规则识别内存马。先找内存马的特征。（这里哥斯拉一直连接不上，连接密码错了，是pass不是password）；

找到tomcat进程，然后右键转为存储文件.dmp       java内存数据.dmp文件

![image-20250119110132401](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119110132401.png)

植入内存马后，用010打开.dmp文件，发现里面存在特征：

![image-20250119110503159](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119110503159.png)

编写内存马规则，几个类作为特征。内存马没有文件，所以这里识别时候是用进程代替的：

![image-20250119111601251](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119111601251.png)

# 225：设备部署

基于主机的入侵检测系统（HIDS）qax 的 ngsoc         H--host

基于网络的入侵检测系统（NIDS)				N--net

#### NIDS



6min  NIDS-Snort

###### snort

先启动snort开始监听网卡，写icmp规则（可以检测如果有icmp请求，就可以记录下来）rules文件，在.conf文件中将写好的icmp规则导入进来，然后ping主 机。

![image-20250119230422225](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119230422225.png)

查看成功收到，监听到icmp的数据：

![image-20250119231218764](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119231218764.png)

监听ICMP协议。

然后将规则文件改一下名字：

![image-20250119231329533](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119231329533.png)

16min  规则        官网也有

![image-20250119231718613](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119231718613.png)

20min  msf生成linux后门上线，正向反向都有，然后分别配置规则用来监听。

我连接外部ip的7799          2、对方端口随机，连接我的（受害机）7799端口

![image-20250119232159103](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119232159103.png)



27min  配置sql注入规则检测，检测数据包中是否有or 1=1这些字符。

![image-20250119232541454](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119232541454.png)

32min  sql注入。使用sqlmap扫描目标，然后配好sql注入的snort规则，查看日志流量：

![image-20250119233107903](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250119233107903.png)

然后开扫、查看日志流量情况：

alert http any any -> any any (msg:"xiaodisec find sqlmap tools attack"; flow:to_server; content:"User-Agent: sqlmap"; http_header; sid:1000016; rev:1;)改了一下sql检测规则：







###### suricata

46min   suricata安装                                 

57min  开始演示、suricata这个规则网上较多。 [入侵检测之流量分析--suricata规则库来源梳理 (qq.com)](https://mp.weixin.qq.com/s/VjWPSVzP0whafH-oCmmvLA)

将检测冰蝎的规则放入：

![image-20250120112048290](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120112048290.png)

监听：

![image-20250120112134773](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120112134773.png)

前面的冰蝎连接web就不演示了：

捕获冰蝎数据：

![image-20250120111349984](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120111349984.png)



1h12 min 

使用goby扫，完了后监听看日志：

![image-20250120113430568](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120113430568.png)

​           

通达oa，当攻击者尝试使用oa攻击工具进行攻击时，我们可以用使用的规则来探测到攻击者的攻击：

![image-20250120114456656](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120114456656.png)

sqlmap

![image-20250120115208087](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120115208087.png)

cs：

![image-20250120115359663](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250120115359663.png)

# 226:设备部署

#### HIDS  后续购买服务器进行复现。

这是攻击已经在主机中，才开始检测的。

Elkeid-----字节的。

7min 这里演示是docker搭建的。

10min 设备搭建在服务端上，然后客户端作为被监控对象。上线主机。

这里开始进入查看客户端报错，换google浏览器后重新进入平台查看。

22min 放一个cs和webshell后门到客户端上让设备进行基线检测，看能不能检测出来。

26min  进行爆破客户端，查看爆破的告警信息



34min Wazuh     外国的

可以配合ELK，自带日志分析功能。

37min  演示上线，连接客户机。

自带att&ck     红队攻击模型 







54min 搭建elk：









# 227：设备部署

堡垒机，蜜罐

ct------长亭

WAF-------雷池--ct

8min  演示搭建

23min 演示wos攻击后的告警。





35min  搭建蜜罐。爆破蜜罐也可以监测到访问。





54min 堡垒机-------jumpserver

堡垒机：帮助企业以更安全的方式管控和登录所有类型的资产

1h07min 堡垒机主页面。他不是保护你的，反而还需要你的保护，因为被拿下后整个账户资产就被拿到了。







# 228：流量分析

webshell工具。

菜刀基本已经淘汰，没有开源，魔改较少。https://mp.weixin.qq.com/s/SjUMoY6EafQzAb3RNWNkpg

bp只能抓到http和https，

##### 蚁剑：

10min  特征点：1、UA头       2、Post提交       3、传参的值base64去掉前面2个字符后可以成功解码。正常都是要么解不了，要么乱码 （这么做可以就是防止被解码发现）         4、@ini_set("display_errors", "0");@set_time_limit(0);

![image-20250122111634305](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122111634305.png)

配好代理，生成后门，连接：

![image-20250122174847934](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122174847934.png)

webshell一般都是Post提交，因为数据包多，get是传不上这么多的。连接上后做一些操作，观察数据包：

post  我这里ua头好像不是antSword/v2.1，也不知为啥。

![image-20250122180811228](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122180811228.png)

Base64编码提交的数据（去掉前2位），这也是特征：

![image-20250122181429466](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122181429466.png)

当连接时候用的为默认时候，这里数据就是ini开始的：

![image-20250122181941604](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122181941604.png)

##### 冰蝎：

20min   UA头，有时候会变，但是都是在他的一个库里面进行随机换。	

数据加密方式可能为aes，这种解密是需要密钥或者偏移量来解密。

![image-20250122113008980](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122113008980.png)

特征1、2、3

![image-20250122182533862](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122182533862.png)

他的数据包是aes加密的，如果不知道加密密钥(webshell连接密码)，那就解不开数据内容。referer也算个特征，冰蝎是有referer：

![image-20250122183247916](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122183247916.png)



##### 天蝎：

37min       冰蝎的延深

![image-20250122184217903](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122184217903.png)

3个特征：

![image-20250122184323627](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122184323627.png)

与冰蝎相比，数据包的加密更换，回显包的加密也更改了：

![image-20250122184558521](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122184558521.png)

##### 哥斯拉

![image-20250122191422806](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122191422806.png)

代理还让我配半天，有两个地方需要改：

![image-20250122190102797](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122190102797.png)

 44min   连接成功会发送3个数据包，失败会发送2个数据包。

成功连接点击success后第3个数据包才出来：

![image-20250122191130097](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122191130097.png)

特征：

![image-20250122191834352](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122191834352.png)

![image-20250122191950007](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122191950007.png)

55min  蓝队分析工具箱，解密webshell工具的数据包------主要还是要知道密钥

这里使用的是默认密钥：

![image-20250122195912572](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122195912572.png)

解密返回包，也是判断的方法之一：

![image-20250122200018432](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122200018432.png)

#### 题型：

1h05min  ctf题型：

目的、给了一个wireshark抓包的数据包：

![image-20250122233720077](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122233720077.png)

首先说了是冰蝎的流量包，那就是http的post请求，先缩小范围：

![image-20250122233754663](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122233754663.png)

下来需要找ip，那就利用的是冰蝎连接时候会加载phpinfo信息（初始化），这里面就有ip等信息，就需要找这个的流量包：

![image-20250122234308281](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122234308281.png)

![image-20250122233948720](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122233948720.png)

将上面加密后的继续解密，得到phpinfo的html代码：

 ![image-20250122234136214](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122234136214.png)



1h32min 第二个   蚁剑

![image-20250122234745882](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250122234745882.png)

还是找，完了解密时候就注意删前2个字符后再解密。



# 229：流量分析

c2远控

![image-20250124145252300](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124145252300.png)

Vshell在今年24hw比较流行

#### cs：

8min    http

将数据包导出来用脚本工具解析，成功后就可以确认为cs后门。下面是cs--http的3个特征

http后门上线，首先就是固定的数据包头：

![image-20250124180959269](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124180959269.png)

还有就是checksum8算法，64位后门对应93、32位的后门对应结果为92：

![image-20250124181231154](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124181231154.png)

还可以对数据包进行解析，成功解析cs的心跳包：

![image-20250124181832077](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124181832077.png)



20min https  是经过加密的，数据包内容是加密的。 看TLS协议的包，然后找两个hello的包。 ja3和ja3s 的值，每个cs版本里的都是固定的，版本不同值不同。这里都是通过对比ja3和ja3s 的值来判断是否为恶意软件。还有一个是其默认引用的证书特征。

抓https后门上线的数据包，找2个hello：

当然每一个cs版本不同，对应的ja3和ja3s的值不同

![image-20250124183012736](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124183012736.png)

将数据包导出https.pcapng。然后用脚本工具可以找到里面的ja3，那么av查杀也是这样找到对应的ja3进而锁定是cs后门。就是将ja3 ja3s值整合一起到库里来检测。

![image-20250124185827072](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124185827072.png)



#### msf

42min  -------- 51min   msf的shell数据包是明文传输：

![image-20250124194900934](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124194900934.png)



52min  msf-http	特征：

![image-20250124201853307](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124201853307.png)

有固定数据包头，get后的路径是随机的，长度也随机：

![image-20250124201926481](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124201926481.png)

混淆上面的MZ文件头：

![image-20250124202016333](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124202016333.png)

57min  msf --https              自然，这里的ja3 ja3s也和msf版本有关。

![image-20250124221041333](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124221041333.png)

#### sliver

[新型渗透工具Sliver的流量特征分析与检测 (qq.com)](https://mp.weixin.qq.com/s/G3ggCKxQy0nOqRuTUPHfiQ)

1h04min 	sliver-http

[奇安信攻防社区-红队工具研究篇 - Sliver C2 (butian.net)](https://forum.butian.net/share/2243)	sliver使用

先在这儿把自己的ip填进去门后面还有个log文件存储地址也需要改一下：

![image-20250127123949034](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127123949034.png)

先生成windows后门-http的：

![image-20250124222142266](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124222142266.png)

上线：

![image-20250124222651695](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124222651695.png)

捕获流量特征：

![image-20250124223615432](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124223615432.png)

可以看到在sliver源码cookie库和路径库中都有对应的：

![image-20250124224127356](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124224127356.png)

根据路径文件名，后缀，cookie这些信息到源码里面的数组随机组合配合分析排查：

![image-20250124231100390](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124231100390.png)

然后就通过这几个条件来满足sliver--http的规则

1h19min sliver-https

生成https的后门，监听，上线：

![image-20250124232205493](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124232205493.png)

将抓到的流量包还是用工具找出ja3和ja3s

![image-20250124231934786](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124231934786.png)

和文章[新型渗透工具Sliver的流量特征分析与检测 (qq.com)](https://mp.weixin.qq.com/s/G3ggCKxQy0nOqRuTUPHfiQ)分析出来的值一样：

![image-20250124232053409](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124232053409.png)

找到这些流量特征后就直接写到自己的edr中：

![image-20250124232426856](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250124232426856.png)



1h27min  工具

# 230：内网隧道

#### frp：

7min   也是分版本，先是0.33版本的，流量包内容中有一些固定特征。

![image-20250125175833688](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125175833688.png)

启动frp，建立隧道：

![image-20250125181210107](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125181210107.png)

然后捕获到建立通讯时候的流量包、捕获特征version.....：

![image-20250125181448111](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125181448111.png)

其中timestamp就是时间戳:

![image-20250125182126636](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125182126636.png)

剩下两个特征包在下面：

![image-20250125181733510](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125181733510.png)

![frp](F:\gayxiaodi\develop\16blue_team\230-蓝队技能-流量分析篇&隧道代理&工具特征&分析项目等\frp.png)

###### 0.44

15min 0.44版本  比0.3版本的流量内容特征少一些  

不难看出，这里面的version比0.33少了：

![image-20250125191054062](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125191054062.png)

###### 0.6

0.6版本，ssl协议

![image-20250125200552902](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125200552902.png)



给配置文件ini中添加tls_enable 或token能实现tls加密。

就是低版本是没有tls加密协议的，所以数据包内容中可以看到固定特征，高版本是自带的，自己已经加密了。所以流量数据包内容是看不到特征的。但这些都可以配。 

0.33版本的frp配置tls加密协议：

![image-20250125201211710](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125201211710.png)

捕获数据包都是经过加密处理的：

![image-20250125201333190](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125201333190.png)

32min 那么如果低版本配置了tls加密，或者高版本自带tls加密、该怎么找特征：

![image-20250125201530830](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125201530830.png)

[内网代理和穿透工具的分析记录 (qq.com)](https://mp.weixin.qq.com/s/APeSpvagBmnrJdjofzh1Yw)

![image-20250125202226243](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125202226243.png)

"Gryphon"协议前客户端携带"0x17"，这就是用了tls加密后frp的一个特征：

![image-20250125202428102](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125202428102.png)

#### nps

41min  --------  54min --1h02min 

![image-20250125205530309](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125205530309.png)

先将nps搭建好，直接./nps就行，ip+8080就可以访问，然后创建好客户端

![image-20250125211956392](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125211956392.png)



http：

特征1：

![image-20250125205723582](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125205723582.png)

特征2：认证成功：服务端向客户端发送sucs，客户端发送main，这里是在nps的源码中定义的，固定的，所以在其流量包中也会有对应的：

![image-20250125210340547](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125210340547.png)

特征3：当你建立socks或者tcp udp连接时，用这些流量通讯后有传输数据特征固定格式。隧道的特征：

产生传输流量，这儿的socks代理是服务器上的，所以自然配置地址也就是服务器的：

![image-20250125211438681](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125211438681.png)

固定特征格式（注意这里需要先产生，也就是让其的socks或者tcp udp产生流量，才会有这个特征）：

![image-20250125211607218](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125211607218.png)

#### Neo-reGeorg

![image-20250125225811935](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125225811935.png)

先设置密码生成后门，上传web服务器，再用工具连接就自动建立了socks5代理：

![image-20250125230250966](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125230250966.png)

注意：这儿的socks代理是本地的，所以配置需要注意。还是用代理让本地socks代理访问网站产生通讯流量，用来找特征：

![image-20250125230818391](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125230818391.png)



踩坑，代理这里是下面这样配的，上面有个验证url，所以一直没有访问产生socks流量：

![image-20250125231644016](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125231644016.png)

特征：html注释的字符串、固定的数据包格式和UA头：

![image-20250125231325146](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125231325146.png)

后面的post数据包和返回包：有cookie    还有加密编码后的字符串------这里是访问产生socks流量后才会产生的数据包：

![image-20250125231935173](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125231935173.png)



#### venom：

![image-20250125232630162](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125232630162.png)

1h21min  服务端启动，客户端连接：

![image-20250125232602993](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125232602993.png)

捕获连接流量：数据包带有"ABCDEFGH"、"VCMD"

![image-20250125233135705](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125233135705.png)

venom的源码-----特征出处。协议数据分隔符、协议特征, 用于在端口重用时鉴别：

![image-20250125233302897](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250125233302897.png)

总结：最后分析特征就是从流量数据包中找到，从源码中分析：下来就是写规则，写防火墙，主要针对网络流量等进行拦截分析。

# 231：规则开发  

##### sliver

写规则：

4min sliver  生成后门上线。

生成两个后门 http和https，后面准备上线使用 suricata进行拦截。



suricata安装windows，8min               

11min .rule文件说明。写一个http/https的规则文件用来检测sliver后门。

![image-20250127132024743](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127132024743.png)

![image-20250127132323185](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127132323185.png)

主要还是需要知道特征，然后自己能口述出给gpt，在稍微修改一下。

监测时候一种是添加到yaml文件中，还可以用命令符指定：

![image-20250127132812238](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127132812238.png)

然后上线sliver-http，并且开启suricata监听，查看fast.log文件，触发了rule规则文件里的js和php规则：

![image-20250127143814342](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127143814342.png)

https的监测，对应的是ja3的hash：

![image-20250127144415008](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127144415008.png)

##### cs：

32min  cs -----38min http

根据提交方式post 和路径固定特征写，再配合checksum8写规则。

先配置下文件，yaml文件中配置打开lua规则，然后将checksum8算法转换为lua语法文件，让suricata检测时候调用，依据这个算法进行规则匹配：

![image-20250127152626856](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127152626856.png)

44min  checksum8算法是不能直接写到规则文件中的，调用lua检查uri是否符合checksum8规则。lua文件就是checksum8算法改过的，将java改成lua代码。

然后这里是配好的cs.rules规则，这个规则里就会检测checksum8的lua文件规则，因为checksum8是不能直接写到rules文件的。最后在fast.log文件中成功检测到cs---http流量：

![image-20250127152601875](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127152601875.png) 

这里的cs。rules是网上找的cs规则：

55min  cs---------https

![image-20250127162119000](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127162119000.png)

#### webshell

1h07min  冰蝎

![image-20250127170347518](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127170347518.png)

哥斯拉：

![image-20250127170424654](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250127170424654.png)

#####  frp

1h22min  frp   规则是针对特征写，

1、版本号对应写成正则式，version":"0.xx.0"

alert tcp any any -> $HOME_NET any (msg:"frp find"; content:"{\"version\":\""; pcre:"/\"version\":\"0\.\d{2}\.\d{1}\"/"; nocase; sid:1000042; rev:1;)

2、根据run_id 特征来写

alert tcp any any -> $HOME_NET any (msg:"frp find"; content:"{\"run_id\":\""; nocase; sid:1000044; rev:1;)

version 后面正则表达式，表示随机的版本号，xx ，

![image-20250128182937173](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250128182937173.png)

##### nps

1h30min nps	检测不到流量包，有时候需要重启一下服务器，因为存在缓存，可能抓不到（日志中）流量，这个发送sucs和main第一次才行，所以需要重启清除缓存。特征是有几个的，但是我们这儿只写了一个特征，后面可以加几条误报的可能就比较低了。

这里是根据特征2![image-20250128183600940](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250128183600940.png)

alert tcp any any -> $HOME_NET any (msg:"nps find"; content:"sucs"; nocase; sid:1000053; rev:1;)

# 232：编程开发

py有许多库比较方便，便于开发出工具脚本

![image-20250204201450188](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204201450188.png)

11min py配合微步的api接口进行测试

![image-20250204205322225](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204205322225.png)

放转义所以文件路径是两个\ \

![image-20250204205633430](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204205633430.png)

运行后会得到hash和分析的网址结果：

![image-20250204210226485](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204210226485.png)

文件信誉报告：

![image-20250204210619403](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204210619403.png)

30min  将这几个配合起来，写到一起：

![image-20250204212756483](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204212756483.png)

1h    分析时候还需要写个等待的延迟，  因为你上传检测的时候是有分析过程的，但是代码调用接口是直接找结果的，然后就会没有找到结果报错，这时候就需要加个if条件让程序sleep一会。       除非你上传的文件是有历史记录的，那么就不需要分析，是直接有结果的：

![image-20250204224751726](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204224751726.png)

1h12min 将分析结果推送给wx，使用的是server酱	

[sct.ftqq.com/sendkey](https://sct.ftqq.com/sendkey)

![image-20250204225452106](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204225452106.png)

1h23min 。



# 233：文件监控

[实时监控文件系统：探索Python Watchdog库的神奇之处！-腾讯云开发者社区-腾讯云 (tencent.com)](https://cloud.tencent.com/developer/article/2384347)

7min   脚本可以监控一些文件/文件夹是否被修改、删除、创建、移动。

![image-20250204231335754](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204231335754.png)

![image-20250204231757001](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204231757001.png)

25min  配合上节的webshell检测脚本，将监控到的可疑文件直接上传检测。

先问gpt，来获取可疑文件的路径和文件名，然后

![image-20250204234800073](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204234800073.png)



42min  修改文件，修改时候会有一个临时文件 后缀带 ~  然后需要加一个if来判断是否为临时文件，   

![image-20250204235032957](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204235032957.png)

![image-20250204235159390](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204235159390.png)



1h  模拟

这里还可以用Py进行流量监测：

if  b  这里b是bit流，

![image-20250205153020609](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205153020609.png)





# 234：sigma

sigma 用来生成各种日志分析平台的恶意筛选语句



二进制就是一些可执行程序（exe等）

![image-20250204164131392](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250204164131392.png)

23min  安装

自带许多规则文件；

![image-20250205165817370](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205165817370.png)



Splunk

分析日志文件的

10min  安装https://mp.weixin.qq.com/s/vcL7eKMYyL-TCsvmvhCI_A

账户splunk   密码：splunk123

打开本地8000端口登录进去，上传日志，然后通过筛选语法分析日志

![image-20250205164832056](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205164832056.png)



36min  sigma 写规则， 运行规则生成对应平台的语句，用语句在对应平台可以进行搜索。

使用web_cve_2021.....规则文件，生成基于splunk平台在windows下的 解析生成语句：

![image-20250205182156710](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205182156710.png)





eg： sigma写一个在日志中查看创建用户的规则，然后运行规则生成Splunk平台的语句，生成的语句在Splunk平台进行搜索，就找出了创建用户的一些日志。



![image-20250205182638960](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205182638960.png)

splunk平台：

![image-20250205182756170](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205182756170.png)



43min 口令爆破的规则。

![image-20250205183019111](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205183019111.png)

在splunk平台上执行：

![image-20250205183030721](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205183030721.png)

# 235：溯源

就是一直查，给ip 或者样本等后，找特征，然后各种平台搜，选择合适的平台搜，社工库等。

![image-20250205220917803](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250205220917803.png)



### ip反查

26min 演示 模拟c2后门上线，找到后门外部的ip

![image-20250207120738555](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207120738555.png)

这里是内网ip，实战中应该是外网ip，找到后就在平台上找就行。

39min  社工库、需要付费，记得开一下小飞机。

![image-20250207162128949](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207162128949.png)

45min  演示 ：  博客的日志，溯源攻击者。

查到了域名解析，然后看到了域名的有效期，这个也是有说法的，域名时间长的话一般就不是攻击域名，因为攻击的话是不会弄长期，容易被查。

在日志中发现有人在爆破自己服务器后台，然后就查ip。

有时候还可以反编译逆向可执行程序，找到攻击者的一些信息。

1h06min 

1h13min  钓鱼邮件溯源      看原件，有ip地址，

# 236：反制

蜜罐 6min  在txt中写一些目录，为一些身份信息指纹的存储路径， 

14min  启动蜜罐，py2版本。开一个3306的sql服务，诱使红队连接。

蓝队人员主动打开一个3306端口，诱导红队连接：

![image-20250207171159978](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207171159978.png)

红队尝试连接后，蓝队这边就成功读取到了目标文件：

![image-20250207171324954](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207171324954.png)

其中.aggressor.prop是红队cs的默认存储连接过的ip信息密码。

![image-20250207171434641](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207171434641.png)

这种还有交互式的：

![image-20250207172541676](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250207172541676.png)

#### 伪装源码泄露：

##### calc

25min  calc.exe       伪装源码泄露、让红队进行审计打开源码上钩：

蓝队配置、制作鱼饵：

![image-20250208155913254](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208155913254.png)

然后蓝队将改好的鱼饵用脚本工具搭建起来、先将idea放到工具目录里，在打开一个web服务，带有源码泄露的一个漏洞，后台www.zip下。制作的页面实战中还是需要进行渲染：

![image-20250208161258036](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208161258036.png)

calc.exe    不是clac，所以第一次翻车了。

红队将www.zip解压用idea打开，注意，这里只针对jer系列的产品打开，比如用记事本打开就不会执行隐藏的鱼饵，用idea打开后发现执行calc，实战不仅要将页面做好看点，也需要将源码等放进来，让其下载解压打开是源码的格式，不是像现在这个里面只有.idea文件：

![image-20250208162255010](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208162255010.png)

##### 1.exe

40min--------52min 利用idea的shell script调试，做一个网站源码，里面带有后门。让红队找到网站源码，用idea打开网址源码的时候会执行我们在源码里放的后门。\

1、制作1.exe后门鱼饵，2、检查好配置 	3、将做好的放到工具目录下

![image-20250208165458153](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208165458153.png)

诱导红队下载存在后门的zip，让其用idea打开进行代码审计：

![image-20250208165821502](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208165821502.png)

红队然后将下载的zip解压，用idea打开：第一次打开有警告，实战中做好后门免杀就行，

红队第二次打开就直接上线了。主要是 .idea文件，里面配置。

![image-20250208165937183](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208165937183.png)

57min  重写做一份



#### 蚁剑

1h06min  反制蚁剑，对版本有限制。修改红队的后门代码，将红队权限反弹回来。

![image-20250208184640091](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208184640091.png)

先用蚁剑连接上：

![image-20250208191907995](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208191907995.png)

然后通过蓝队排查，发现了蚁剑后门文件，对其进行反制。

通过修改后门shell，让其反弹权限：

![image-20250208192843191](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208192843191.png)

将更改后的代码替换蚁剑后门，在监听反弹端口。然后当红队在用蚁剑尝试连接时候，就会反弹shell回来：

![image-20250208193129293](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208193129293.png)

#### sqlmap

1h15min   鸡肋，只能用linux的sqlmap进行攻击，利用的是linux的sqlmap在注入网站时候后面如果有参数，可以执行参数命令，我们就是让这里执行我们的反弹命令。

![image-20250208194101601](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208194101601.png)

这里先做一个提交表单的页面，诱导其对提交框进行sql注入，然后正常思路，红队对其提交数据抓包、对抓包参数进行sql注入：

![image-20250208195136958](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208195136958.png)

这里后面参数是base64加密的反弹shell命令，看着还是比较明显的，红队不会傻到看不出来，但是实战你需要多层加密，自己想办法让其变得真一点，还有这个提交表单的页面，也需要改一下（好看逼真点）：

![image-20250208195357290](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208195357290.png)

红队对提交的参数进行测试，使用的是linux的sqlmap。蓝队进行监听：

![image-20250208195518341](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208195518341.png)

1h32min goby

制作一个网页，当红队用goby扫的时候会发现漏洞：

![image-20250208201045854](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208201045854.png)

然后用goby扫后查看结果时候一点开就会执行我们的命令：

![image-20250208201335901](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250208201335901.png)



# 237：暴打红队

反制是溯源之后的

#### 反制cs

批量上线    、条件：知道对方的CS的服务端地址，开启了http监听器

10min   批量上线  需要解密流量包中的cookie的值，找到里面的公钥信息，用一个脚本实现批量发包，让对方（红队）cs批量上线大量机器。

得不到公钥的话只能上线一个机器。

##### 批量上线

欺骗防御，先用没有得到公钥的cookie进行发包，找到有cookie头的cs上线数据包：

![image-20250209122851677](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209122851677.png)

然后用发包工具发包，其中对应头的值，发现只能上线一次，不能实现发多次包上线多次：

![image-20250209123133996](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209123133996.png)

![image-20250209123252690](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209123252690.png)

所以需要用得到正确的公钥加密成正确的cookie进行多次发包：

解密cookie并找到公钥：1、先 找到后门地址  	2、下载后门文件 	3、解密其中的cookie	4、解密后的转为json格式的文件查看     这里出来的是解密后的cookie

![image-20250209130844990](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209130844990.png)

然后再找到cookie里面的公钥：

![image-20250209131048603](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209131048603.png)

将得到的公钥存到准备批量发包工具下的对应txt文件中，这里面其他txt文件是cs上线后的对应一些用户，计算机，进程的信息：

![image-20250209131229909](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209131229909.png)

进行批量发包10次，这里主要c2的URL不要写成后门地址，可以看到cs上线10台，这里面上线的用户，计算机，进程等信息都可以在上面的txt文件中修改。主要是公钥和cs的url。

![image-20250209131400336](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209131400336.png)

##### 2：爆破密码

25min 条件 ： 知道对方的CS的服务端地址---------前面溯源到的。

在通过端口扫描扫出来cs的端口。然后用脚本爆破cs的密码。

![image-20250209183139690](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209183139690.png)

##### 3、cve 

46min  内置漏洞 ，条件：机器被CS控制的木马程序 Cobalt Strike <=4.7 XSS 操作过进程管理

将两个文件放到一个网站目录下，下来就用cve脚本进行。运行后红队会上线蓝队操作的机器，只要红队查看目标进程列表，那么红队机器就会执行前面两个文件里的rce。

将程序打包成jar包，让红队弹计算器：

![image-20250209190904389](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209190904389.png)



这里用脚本进行上线：

![image-20250209191239995](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209191239995.png)

然后只要一点击进程列表，那么红队的权限就反弹回来，这里是弹的计算器：

![image-20250209191047069](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209191047069.png)

##### 4、旁站反制

55min ![image-20250209191553847](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209191553847.png)

就是你找到了c2服务器的ip，还可以在其服务器上发现有没有其他的服务，比如一般来说会配合着nps这种内网工具，那么我们可以打nps达到反制红队：

这里演示是随便找一个nps服务：1、登录页面抓包 	2、使用bp自带插件直接进入nps	3、放包刷新直接进去

![image-20250209192831804](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209192831804.png)

钓鱼：

1h05min 

![image-20250209193003314](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250209193003314.png)

# 238：报告书写（简历）

#### 风险报告

1min  py脚本生成风险报告模板。漏洞风险报告	ReportGenX.py

#### 渗透报告

5min 渗透报告生成。docker搭建的平台。不过这里用kali搭建的好像有点卡，后期可以专门弄个大的内存搭建。

![image-20250210001249145](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210001249145.png)

模板跟着写就行，没什么技术含量：

![image-20250210001611567](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210001611567.png)



10min 蓝队值守报告        小翻车，在25min评论区解决----------没解决LazyAnFuZai.jar

https://github.com/R4gd0ll/LazyAnFuZai

17min  简历模板

19min  靶场 ------玄机 

## 云函数

https://xz.aliyun.com/t/11625

https://mp.weixin.qq.com/s/Js6i71wYTGoeM1sG8H8D6g

https://mp.weixin.qq.com/s/CI_C7zrH5vfzPs1XQiRqug  ---靠运气可以查到其appid 最后可以查到个人ip信息。

https://cloud.tencent.com/developer/article/2437292

![image-20250210002412990](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210002412990.png)

45min  演示项目ddos  反制云函数。

消耗云函数资源，占用资源：使用工具对其资源进行ddos。

![image-20250210003120662](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210003120662.png)

可以看到，还是有点用的，占用了一定的资源：

![image-20250210003208638](E:\新建文件夹\新建文件夹\typora学习笔记软件\缓存\image-20250210003208638.png)















